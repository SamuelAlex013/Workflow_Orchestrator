# N8N Kafka Enhanced Nodes

–£–ª—É—á—à–µ–Ω–Ω—ã–µ Kafka –Ω–æ–¥—ã –¥–ª—è n8n —Å —Ä—É—á–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º offset'–∞–º–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π n8n Kafka –Ω–æ–¥–µ.

## üéØ –ü–æ–¥—Ö–æ–¥

–í–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Å –Ω—É–ª—è, –º—ã –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é n8n Kafka –Ω–æ–¥—É, –¥–æ–±–∞–≤–ª—è—è:

1. **–û–ø—Ü–∏—é —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è offset'–∞–º–∏** –≤ Kafka Trigger
2. **–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫–æ–º–º–∏—Ç–∞ offset'–æ–≤** –≤ Kafka Response –Ω–æ–¥–µ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π timeout –∏ retry –º–µ—Ö–∞–Ω–∏–∑–º** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≤–∏—Å—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

## ‚ú® –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **üîß –û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π n8n Kafka –Ω–æ–¥–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- **‚öôÔ∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ offset'–∞–º–∏** - –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **üõ°Ô∏è –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è Kafka –Ω–æ–¥–∞ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–Ω–æ–º —Ä—É—á–Ω–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
- **üìä –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ workflow
- **‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π timeout** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å retry –º–µ—Ö–∞–Ω–∏–∑–º–æ–º
- **üö® –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install n8n-nodes-kafka-enhanced
```

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. Kafka Trigger (Enhanced)

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä —Å –æ–ø—Ü–∏–µ–π **Manual Offset Management**:

- **Topic**: –∏–º—è —Ç–æ–ø–∏–∫–∞ Kafka
- **From Beginning**: —á–∏—Ç–∞—Ç—å —Å –Ω–∞—á–∞–ª–∞ —Ç–æ–ø–∏–∫–∞
- **Manual Offset Management**: ‚úÖ **–í–ö–õ–Æ–ß–ò–¢–¨** –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è offset'–∞–º–∏
- **Session ID**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏
- **Message Timeout (minutes)**: —Ç–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5 –º–∏–Ω—É—Ç)
- **Max Retries**: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 3)
- **Auto Commit on Timeout**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–º–º–∏—Ç–∏—Ç—å offset –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫

### 2. Kafka Response (Enhanced)

–í –∫–æ–Ω—Ü–µ workflow –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–¥—É Kafka Response:

#### –î–µ–π—Å—Ç–≤–∏—è –≤ Response –Ω–æ–¥–µ:

- **Commit Offset** - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—Å–ø–µ—à–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å offset
  - ‚úÖ Offset –∫–æ–º–º–∏—Ç–∏—Ç—Å—è
  - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º
  - ‚úÖ –ù–µ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

- **Mark Failed** - –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ –Ω–µ—É–¥–∞—á–Ω—É—é (offset –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
  - ‚ùå Offset –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—Å—è
  - üîÑ –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–Ω–æ–≤–æ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
  - üîÑ –ë—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ —á–µ—Ä–µ–∑ timeout –º–µ—Ö–∞–Ω–∏–∑–º

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
- `messageId` - ID —Å–æ–æ–±—â–µ–Ω–∏—è
- `topic` - —Ç–æ–ø–∏–∫ Kafka
- `partition` - –ø–∞—Ä—Ç–∏—Ü–∏—è
- `offset` - offset —Å–æ–æ–±—â–µ–Ω–∏—è
- `retryCount` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
- `isRetry` - —ç—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞?
- `sessionId` - ID —Å–µ—Å—Å–∏–∏
- `consumerGroupId` - ID –≥—Ä—É–ø–ø—ã –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–µ–π

## üîÑ Workflow –ø—Ä–∏–º–µ—Ä

```
Kafka Trigger (Enhanced) ‚Üí Process Data ‚Üí Validate ‚Üí Kafka Response (Commit Offset)
    [Manual Offset: ON]       ‚Üì
                         Error Handler ‚Üí Kafka Response (Mark Failed)
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. **Manual Offset Management**: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ
2. **Message Timeout**: 5 –º–∏–Ω—É—Ç
3. **Max Retries**: 3 –ø–æ–ø—ã—Ç–∫–∏
4. **Auto Commit on Timeout**: ‚úÖ –í–∫–ª—é—á–µ–Ω–æ
5. **Error Handler**: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –¥–ª—è –≤—Å–µ—Ö workflow

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

- **Message Timeout**: 5 –º–∏–Ω—É—Ç
- **Max Retries**: 3 –ø–æ–ø—ã—Ç–∫–∏
- **Auto Commit on Timeout**: –≤–∫–ª—é—á–µ–Ω–æ

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ timeout

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ:

1. **–û—à–∏–±–∫–∞ –≤ workflow –±–µ–∑ Error Handler**:
   - ‚è∞ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ timeout –º–µ—Ö–∞–Ω–∏–∑–º
   - üîÑ –ß–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
   - üîÑ –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - ‚úÖ –ü–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ offset –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è

2. **–û—à–∏–±–∫–∞ —Å Error Handler**:
   - ‚ùå Error Handler –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
   - üéØ Error Handler –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∏—Ç—å Kafka Response —Å –¥–µ–π—Å—Ç–≤–∏–µ–º "Mark Failed"
   - üîÑ –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–Ω–æ–≤–æ

3. **–£—Å–ø–µ—à–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**:
   - ‚úÖ Kafka Response —Å –¥–µ–π—Å—Ç–≤–∏–µ–º "Commit Offset"
   - ‚úÖ Offset –∫–æ–º–º–∏—Ç–∏—Ç—Å—è
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:

- `Retrying message {messageId}, attempt {count}` - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞
- `Max retries exceeded for message {messageId}, taking action` - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫
- `Committed offset for failed message {messageId}` - –∫–æ–º–º–∏—Ç –ø–æ—Å–ª–µ timeout

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã** –Ω–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ timeout
2. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ retry** –≤ –ª–æ–≥–∞—Ö
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ pending —Å–æ–æ–±—â–µ–Ω–∏—è** –≤ Kafka

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Kafka Trigger
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `autoCommit: false` –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º —Ä—É—á–Ω–æ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
- –ü–µ—Ä–µ–¥–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å consumer reference –¥–ª—è –∫–æ–º–º–∏—Ç–∞
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π n8n Kafka –Ω–æ–¥—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç timeout –º–µ—Ö–∞–Ω–∏–∑–º —Å retry –ª–æ–≥–∏–∫–æ–π

### Kafka Response
- –ü–æ–ª—É—á–∞–µ—Ç consumer reference –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –í—ã–ø–æ–ª–Ω—è–µ—Ç `consumer.commitOffsets()` –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ
- –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç offset –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö, –ø–æ–∑–≤–æ–ª—è—è –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### Timeout –º–µ—Ö–∞–Ω–∏–∑–º
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç pending —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- Retry –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ timeout
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –ø–æ–ø—ã—Ç–æ–∫

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [n8n Kafka Documentation](https://docs.n8n.io/integrations/builtin/app-nodes/n8n-nodes-base.kafka/)
- [KafkaJS Documentation](https://kafka.js.org/)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT