# n8n Nodes - Agent Data Shuttle

Custom n8n.io nodes for ADS Publisher and ADS Subscriber â€” _Design autonomous agentic workflows with real-time event-driven AI._

> **Agent Data Shuttle** provides plug-and-play **n8n nodes** for integrating ADS Publisher and ADS Subscriber into your workflows. These nodes enable seamless event publishing and agentic event subscription, allowing your AI agents to react autonomously to external events via the ADS ecosystem.

---

## Table of Contents

- [Overview](#overview)
- [Quick Start](#quick-start)
- [Architecture](#architecture)
- [Getting Started](#getting-started)
  - [Prerequisites](#prerequisites)
  - [Installation](#installation)
  - [Usage](#usage)
- [Node Details](#node-details)
  - [ADS Publisher Node](#ads-publisher-node)
  - [ADS Subscriber Node](#ads-subscriber-node)
- [Credentials](#credentials)
- [Project Structure](#project-structure)
- [Development](#development)
- [License](#license)
- [Contact](#contact)

---

## Overview

This package contains custom [n8n](https://n8n.io/) nodes for the Agent Data Shuttle (ADS) framework:

- **ADS Publisher Node**: Publishes events to the ADS Bridge via RabbitMQ.
- **ADS Subscriber Node**: Subscribes to events from ADS Bridge, contextualizes them with an LLM, and triggers agentic workflows.

These nodes are designed for easy integration into n8n workflows, enabling real-time, autonomous event-driven AI agent orchestration.

> For illustrative installation and usage, refer to the [Agent Data Shuttle documentation](https://agentdatashuttle.knowyours.co/n8n).

---

## Quick Start

### Install via n8n GUI (Recommended)

1. In your n8n instance, go to **Settings > Community Nodes**.
2. Click **Install** and enter the npm package name:
   ```
   @agentdatashuttle/n8n-nodes-agent-data-shuttle
   ```
3. Agree to the risks and click **Install**.
4. Restart n8n if required.

### Add ADS Publisher and Subscriber Nodes

- In your n8n workflow editor, search for **ADS Publisher** and **ADS Subscriber** nodes.
- Drag them into your workflow and configure credentials as described below.

---

## Architecture

- **ADS Publisher Node**: Publishes events to RabbitMQ, which are then relayed by ADS Bridge.
- **ADS Subscriber Node**: Connects to ADS Bridge via WebSocket, receives events, and invokes an LLM for contextualization.
- **Credentials**: Securely manage connection details for RabbitMQ and ADS Bridge.
- **LLM Integration**: The Subscriber node supports linking to an n8n LLM node for prompt contextualization and autonomous agent invocation.

![Architecture Diagram](https://agentdatashuttle.knowyours.co/architecture-diagram.png)

---

## Getting Started

### Prerequisites

- [Node.js](https://nodejs.org/) (v20+ recommended)
- [n8n](https://n8n.io/) (latest version)
- Access to an ADS Bridge instance for desired ADS Publisher (see [ADS Bridge](https://github.com/agentdatashuttle/ads-bridge))
- RabbitMQ (if you are building an ADS Publisher)
- Redis (for event handling and scaling)

### Usage

1. **Configure Credentials**

   - For Publisher: Set RabbitMQ connection parameters.
   - For Subscriber: Set ADS Bridge connection string and Redis details.

2. **Design Workflows**
   - Use the **ADS Publisher** node to send events.
   - Use the **ADS Subscriber** node to receive and process events, further linking for agentic responses.

---

## Node Details

### ADS Publisher Node

Publishes events to ADS Bridge via RabbitMQ.

- **Inputs**: Main input (event payloads)
- **Outputs**: Main output (publish status and payloads)
- **Required Credentials**: `adsRabbitMQClientParamsApi`
  **Properties**:
  - `ADS Publisher Name`: Identifier for the publisher

See implementation: `nodes/AdsPublisher/AdsPublisher.node.ts`

### ADS Subscriber Node

Subscribes to events from ADS Bridge and invokes an LLM for contextualization.

- **Inputs**: LLM connection (via `AiLanguageModel`)
- **Outputs**: Main output (agent invocation prompt and event payload)
- **Required Credentials**: `adsBridgeClientParamsApi`
- **Properties**:
  - `ADS Subscriber Name`: Identifier for the subscriber
  - `Agent description`: Description of the agent triggered by this subscriber

#### How it works

- On workflow activation, the node connects to ADS Bridge using credentials and subscribes to the configured socket event.
- When an ADS event is received, it triggers the workflow and passes the event payload.
- The node expects an LLM input connection (via n8n's AI Language Model node). It sends the event contextualization prompt to the LLM, receives the response, and outputs:
  - `ads_agent_invocation_prompt`: The final prompt for agent invocation, generated by the LLM.
  - `ads_event_payload`: The original event payload.

See implementation: `nodes/AdsSubscriber/AdsSubscriber.node.ts`

---

## Credentials

### ADSRabbitMQClientParamsApi.credentials

**Used by:** ADS Publisher Node

**Credential type name:** `ADSRabbitMQClientParamsApi`

**Purpose:** Stores RabbitMQ connection details for publishing events.

**Required fields:**

- Host
- Port
- Username
- Password

**Setup:**

1. In n8n, go to Credentials and create a new credential of type **ADSRabbitMQClientParamsApi**.
2. Enter your RabbitMQ server details.
3. Save and select this credential in the ADS Publisher node.

See: `credentials/ADSRabbitMQClientParamsApi.credentials.ts`

### ADSBridgeClientParamsApi.credentials

**Used by:** ADS Subscriber Node

**Credential type name:** `ADSBridgeClientParamsApi`

**Purpose:** Stores ADS Bridge and Redis connection details for subscribing to events.

**Required fields:**

- **ADS Bridge connection string**: The full URL or connection string to your ADS Bridge instance (e.g., `http://ads-bridge.example.com:8080`).
- **Path prefix**: The API path prefix used for routing requests to ADS Bridge (e.g., `/ads`).
- **Redis host**: Hostname or IP address of your Redis server for event scaling and delivery.
- **Redis port**: Port number for your Redis server (default is usually `6379`).
- **Redis username**: Username of your Redis server (optional).
- **Redis password**: Password for your Redis server (optional).
- **Socket event name**: The name of the socket event to subscribe to for receiving ADS events (e.g., `ads_event`).
- **Pool ID**: Unique identifier for the subscriber pool or group this subscriber belongs to, used for targeted event delivery and agent orchestration.

**Setup:**

1. In n8n, go to Credentials and create a new credential of type **ADSBridgeClientParamsApi**.
2. Fill in each field:
   - **ADS Bridge connection string**: Enter the URL to your ADS Bridge instance.
   - **Path prefix**: Specify the API path prefix (if required by your ADS Bridge setup).
   - **Redis host**: Enter your Redis server's hostname or IP.
   - **Redis port**: Enter your Redis server's port number.
   - **Redis username**: (Optional) Enter your Redis username.
   - **Redis password**: (Optional) Enter your Redis password.
   - **Socket event name**: Enter the event name to listen for (check ADS Bridge configuration documented by your desired ADS Publisher).
   - **Pool ID**: Enter the pool/group ID for your agent subscriber (Generate one using [Pool ID Generator](https://agentdatashuttle.knowyours.co/pool-id-generator) tool).
3. Save and select this credential in the ADS Subscriber node.

See: `credentials/ADSBridgeClientParamsApi.credentials.ts`

---

## Project Structure

```
credentials/
  ADSBridgeClientParamsApi.credentials.ts
  ADSRabbitMQClientParamsApi.credentials.ts
nodes/
  AdsPublisher/
    AdsPublisher.node.ts
    AdsPublisher.node.json
    ads_logo_dark.svg
    ads_logo_light.svg
  AdsSubscriber/
    AdsSubscriber.node.ts
    AdsSubscriber.node.json
    ads_logo_dark.svg
    ads_logo_light.svg
utils/
  chat_instance.ts
gulpfile.js
package.json
README.md
```

- Publisher node: `nodes/AdsPublisher/AdsPublisher.node.ts`
- Subscriber node: `nodes/AdsSubscriber/AdsSubscriber.node.ts`
- Credentials: `credentials/ADSRabbitMQClientParamsApi.credentials.ts`, `credentials/ADSBridgeClientParamsApi.credentials.ts`
- Utility: `utils/chat_instance.ts`

---

## Resources

- [n8n community nodes documentation](https://docs.n8n.io/integrations/#community-nodes)
- [Agent Data Shuttle documentation](https://agentdatashuttle.knowyours.co)
- [ADS Bridge GitHub](https://github.com/agentdatashuttle/ads-bridge)

---

## License

This project is licensed under the **MIT License**

---

## Contact

For questions or support, please contact  
[agentdatashuttle@knowyours.co](mailto:agentdatashuttle@knowyours.co)

For more information about Agent Data Shuttle:  
https://agentdatashuttle.knowyours.co
